## -------------------------------------------------------------------------------------
library("tidyverse")


## -------------------------------------------------------------------------------------
set.seed(20180219)
(y <- rnorm(10, mean = 3.2, sd = 1.1)) # 3.2 and 1.1 are the population parameters


## -------------------------------------------------------------------------------------
(ybar <- mean(y))


## -------------------------------------------------------------------------------------
n <- length(y)
s <- sd(y)

ybar + c(-1,1)*qt(.975, df = n-1)*s/sqrt(n)


## -------------------------------------------------------------------------------------
t.test(y)


## -------------------------------------------------------------------------------------
tt <- t.test(y)
names(tt)
str(tt)


## -------------------------------------------------------------------------------------
tt$estimate
tt$conf.int


## -------------------------------------------------------------------------------------
t.test(y, alternative = "less",    mu = 1,  conf.level = 0.9)


## -------------------------------------------------------------------------------------
t.test(y, alternative = "greater", mu = -1, conf.level = 0.99)


## -------------------------------------------------------------------------------------
set.seed(1)
y <- rnorm(1001, mean = 256, sd = 34.6)




## -------------------------------------------------------------------------------------
a <- b <- 1
n <- 13
y <- 9


## -------------------------------------------------------------------------------------
ggplot(data.frame(x=c(0,1)), aes(x=x)) + 
  stat_function(fun = dbeta, 
                args = list(shape1 = a+y,
                            shape2 = b+n-y)) + 
  labs(x = expression(theta),
       y = paste(expression("p(",theta,"|y)")),
       title = "Posterior distribution for probability of success") +
  theme_bw()


## -------------------------------------------------------------------------------------
(a+y)/(a+b+n)


## -------------------------------------------------------------------------------------
qbeta(c(.025,.975), a+y, b+n-y)


## -------------------------------------------------------------------------------------
1-pbeta(0.5, a+y, b+n-y)




## -------------------------------------------------------------------------------------
n <- 13
y <- 9
binom.test(y, n)


## -------------------------------------------------------------------------------------
sum(dbinom(c(0:4,9:13), size = n, prob = 0.5))


## -------------------------------------------------------------------------------------
ci <- binom.test(y,n)$conf.int
binom.test(y, n, p=ci[2])$p.value # This one matches exactly
binom.test(y, n, p=ci[1])$p.value # This one is close




## -------------------------------------------------------------------------------------
n <- 100
y <- 78
prop.test(y,n)


## -------------------------------------------------------------------------------------
pt <- prop.test(y,n)
pt$estimate


## -------------------------------------------------------------------------------------
pt$conf.int


## -------------------------------------------------------------------------------------
p <- y/n
p + c(-1,1)*qnorm(.975)*sqrt(p*(1-p)/n)


## -------------------------------------------------------------------------------------
prop.test(y, n, correct = FALSE)






## -------------------------------------------------------------------------------------
set.seed(20180220)
# Generate some simulated data
n <- 100
d <- data.frame(rep = 1:n,
                response = sample(c("Yes","No"), n, replace=TRUE, prob = c(.2,.8)),
                measurement = rnorm(n, mean = 55, sd = 12))

# Write it to a file
# make sure you have set your working directory to someplace where you want this
# file to be written
write.csv(d, 
          file = "data.csv",
          row.names = FALSE)


## ---- eval=FALSE----------------------------------------------------------------------
## install.packages("readr")
## library("readr")
## write_csv(d, path = "data.csv")


## -------------------------------------------------------------------------------------
my_data <- read.csv("data.csv")




## -------------------------------------------------------------------------------------
head(my_data)
str(my_data)


## -------------------------------------------------------------------------------------
y <- sum(my_data$response == "Yes")
n <- length(my_data$response)
prop.test(y, n)
binom.test(y, n)


## -------------------------------------------------------------------------------------
t.test(my_data$measurement)




## ---- eval=FALSE----------------------------------------------------------------------
## install.packages("Sleuth3")
## library("Sleuth3")
## ?case0101


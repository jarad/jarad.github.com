## ----libraries, message=FALSE, warning=FALSE, cache=FALSE, echo=FALSE-----------
library("tidyverse"); theme_set(theme_bw())
library("Sleuth3")
library("emmeans")
library("GGally")


## ----set_seed, echo=FALSE-------------------------------------------------------
set.seed(20220215)


## -------------------------------------------------------------------------------
mouse <- read_csv('mouse.csv') %>% 
  mutate(Mouse = factor(Mouse),
         Mouse = relevel(Mouse, ref="Dell"))
head(mouse)
summary(mouse)


## -------------------------------------------------------------------------------
ggplot(mouse, aes(x = Mouse, y = Skill)) + geom_jitter(width=0.1)


## -------------------------------------------------------------------------------
m <- lm(Skill ~ Mouse, data = mouse)
summary(m)


## -------------------------------------------------------------------------------
coef(m)
confint(m)


## -------------------------------------------------------------------------------
em <- emmeans(m, pairwise ~ Mouse, adjust = "none")
confint(em)


## -------------------------------------------------------------------------------
summary(m)


## -------------------------------------------------------------------------------
anova(m)


## -------------------------------------------------------------------------------
anova(m)


## -------------------------------------------------------------------------------
anova(m)


## -------------------------------------------------------------------------------
case0502 <- Sleuth3::case0502 %>% mutate(Judge = relevel(Judge, ref="Spock's"))
head(case0502)
summary(case0502)


## -------------------------------------------------------------------------------
ggplot(case0502, aes(x = Judge, y = Percent)) + geom_jitter(width=0.1)


## -------------------------------------------------------------------------------
m <- lm(Percent ~ Judge, data = case0502)
anova(m)


## -------------------------------------------------------------------------------
summary(m)


## -------------------------------------------------------------------------------
em <- emmeans(m, trt.vs.ctrl ~ Judge, adjust = "none")
confint(em)


## -------------------------------------------------------------------------------
em <- emmeans(m, ~ Judge)
co <- contrast(em, list(`Mean(others) - Spock` = c(-7, rep(1,6))/7))
confint(co)


## -------------------------------------------------------------------------------
head(case1301)
summary(case1301)


## -------------------------------------------------------------------------------
ggplot(case1301, aes(x = Block, y = Cover, shape=Treat, color=Treat)) + geom_jitter(width=0.1, height=0)


## -------------------------------------------------------------------------------
m <- lm(Cover ~ Block + Treat, data = case1301)
summary(m)


## -------------------------------------------------------------------------------
anova(m)


## -------------------------------------------------------------------------------
anova(m)


## -------------------------------------------------------------------------------
head(case1302)
summary(case1302)


## -------------------------------------------------------------------------------
ggplot(case1302, aes(x = Company, y = Score, shape=Treat, color=Treat)) + geom_jitter(width=0.1, height=0)


## -------------------------------------------------------------------------------
m <- lm(Score ~ Company + Treat, data = case1302)
summary(m)


## -------------------------------------------------------------------------------
anova(m)


## -------------------------------------------------------------------------------
anova(m)


## -------------------------------------------------------------------------------
drop1(m, test="F")


## -------------------------------------------------------------------------------
m <- lm(log(Forrest) ~ Stress + factor(SO2) + factor(O3), data = case1402)
drop1(m, test="F")


## -------------------------------------------------------------------------------
m <- lm(log(Forrest) ~ .^2, data = case1402 %>% select(-William))
drop1(m, test="F")


## ----libraries, message=FALSE, warning=FALSE, cache=FALSE, echo=FALSE----------------------------
library("tidyverse"); theme_set(theme_bw())
library("Sleuth3")
library("ggResidpanel")
library("emmeans")


## ----set_seed, echo=FALSE------------------------------------------------------------------------
set.seed(20220215)


## ------------------------------------------------------------------------------------------------
ex0726


## ------------------------------------------------------------------------------------------------
summary(ex0726)


## ------------------------------------------------------------------------------------------------
ggplot(ex0726, aes(x=Mother, y=Height, color = Gender)) + geom_point()


## ------------------------------------------------------------------------------------------------
ggplot(ex0726 %>% filter(Gender == "female"),
       aes(x=Mother, y=Height)) + geom_jitter()


## ------------------------------------------------------------------------------------------------
m <- lm(Height ~ Mother, data = ex0726 %>% filter(Gender == "female"),)
summary(m)


## ------------------------------------------------------------------------------------------------
m <- lm(Height ~ I(Mother-64), data = ex0726)


## ------------------------------------------------------------------------------------------------
resid_panel(m, plots = c("qq","resid","index","cookd"), smooth = TRUE, qqbands = TRUE)


## ------------------------------------------------------------------------------------------------
summary(m)


## ------------------------------------------------------------------------------------------------
co <- coef(m)
co
ci <- confint(m)
ci


## ------------------------------------------------------------------------------------------------
ggplot(ex0726 %>% filter(Gender == "female"),
       aes(x=Mother, y=Height, color = Father)) + geom_jitter()


## ------------------------------------------------------------------------------------------------
m <- lm(Height ~ Mother + Father, data = ex0726 %>% filter(Gender == "female"))
summary(m)


## ------------------------------------------------------------------------------------------------
m <- lm(Height ~ I(Mother-64) + I(Father-69), data = ex0726 %>% filter(Gender == "female"))


## ------------------------------------------------------------------------------------------------
resid_panel(m, plots = c("qq","resid","index","cookd"), smooth = TRUE, qqbands = TRUE)


## ------------------------------------------------------------------------------------------------
summary(m)


## ------------------------------------------------------------------------------------------------
co <- coef(m)
co
ci <- confint(m)
ci


## ------------------------------------------------------------------------------------------------
ggplot(ex0726, aes(x=Mother, y=Height, color = Father, shape=Gender)) + geom_jitter()


## ------------------------------------------------------------------------------------------------
m <- lm(Height ~ Mother + Father + Gender, data = ex0726)
summary(m)


## ------------------------------------------------------------------------------------------------
m <- lm(Height ~ I(Mother-64) + I(Father-69) + Gender, data = ex0726)


## ------------------------------------------------------------------------------------------------
resid_panel(m, plots = c("qq","resid","index","cookd"), smooth = TRUE, qqbands = TRUE)


## ------------------------------------------------------------------------------------------------
summary(m)


## ------------------------------------------------------------------------------------------------
co <- coef(m)
co
ci <- confint(m)
ci


## ------------------------------------------------------------------------------------------------
warpbreaks


## ------------------------------------------------------------------------------------------------
summary(warpbreaks)


## ------------------------------------------------------------------------------------------------
ggplot(warpbreaks, aes(x=tension, y=breaks, color=wool, shape=wool)) + geom_point()


## ------------------------------------------------------------------------------------------------
ggplot(warpbreaks %>% filter(wool == "A"), aes(x=tension, y=breaks)) + geom_point()


## ------------------------------------------------------------------------------------------------
m <- lm(breaks ~ tension, data = warpbreaks %>% filter(wool == "A"))


## ------------------------------------------------------------------------------------------------
resid_panel(m, plots = c("qq","resid","index","cookd"), smooth = TRUE, qqbands = TRUE)


## ------------------------------------------------------------------------------------------------
summary(m)


## ------------------------------------------------------------------------------------------------
co <- coef(m)
co
ci <- confint(m)
ci


## ------------------------------------------------------------------------------------------------
em <- emmeans(m, pairwise ~ tension, adjust = "none")
confint(em)


## ------------------------------------------------------------------------------------------------
ggplot(warpbreaks, aes(x=tension, y=breaks, color=wool, shape=wool)) + geom_point()


## ------------------------------------------------------------------------------------------------
m <- lm(breaks ~ tension + wool, data = warpbreaks)


## ------------------------------------------------------------------------------------------------
resid_panel(m, plots = c("qq","resid","index","cookd"), smooth = TRUE, qqbands = TRUE)


## ------------------------------------------------------------------------------------------------
summary(m)


## ------------------------------------------------------------------------------------------------
co <- coef(m)
co
ci <- confint(m)
ci


## ------------------------------------------------------------------------------------------------
em <- emmeans(m, pairwise ~ tension, adjust = "none")
confint(em)


## ------------------------------------------------------------------------------------------------
em <- emmeans(m, pairwise ~ wool, adjust = "none")
confint(em)


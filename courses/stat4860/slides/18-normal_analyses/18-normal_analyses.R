## --------------------------------------------------------------------------------------------------------------------------------------
library("tidyverse"); theme_set(theme_bw())
library("Sleuth3")
set.seed(20230319)


## --------------------------------------------------------------------------------------------------------------------------------------
creativity <- case0101 %>%
  filter(Treatment == "Intrinsic")


## --------------------------------------------------------------------------------------------------------------------------------------
summary(creativity)

creativity %>%
  summarize(
    n = n(),
    mean = mean(Score),
    sd = sd(Score)
  )


## --------------------------------------------------------------------------------------------------------------------------------------
ggplot(creativity, aes(x = Score)) + 
  geom_histogram()


## --------------------------------------------------------------------------------------------------------------------------------------
ggplot(creativity, aes(x = Score)) + 
  geom_boxplot(outlier.shape = NA)


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(creativity$Score)


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(Score ~ 1, data = creativity)


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(creativity$Score, mu = 20, alternative = "greater", conf.level = 0.9)


## --------------------------------------------------------------------------------------------------------------------------------------
case0101 %>%
  group_by(Treatment) %>%
  summarize(
    n = n(),
    mean = mean(Score),
    sd = sd(Score),
    .groups = "drop"
  )


## --------------------------------------------------------------------------------------------------------------------------------------
intrinsic <- case0101$Score[case0101$Treatment == "Intrinsic"]
extrinsic <- case0101$Score[case0101$Treatment == "Extrinsic"]


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(extrinsic, intrinsic)


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(Score ~ Treatment, data = case0101)


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(Score ~ Treatment, data = case0101, var.equal = TRUE)


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(Score ~ Treatment, data = case0101, var.equal = TRUE,
       mu = 5, alternative = "greater", conf.level = 0.9)


## --------------------------------------------------------------------------------------------------------------------------------------
summary(case0202)


## --------------------------------------------------------------------------------------------------------------------------------------
schizophrenia <- case0202 %>%
  mutate(pair = LETTERS[1:n()]) %>%
  pivot_longer(-pair, names_to = "diagnosis", values_to = "volume")


## --------------------------------------------------------------------------------------------------------------------------------------
ggplot(schizophrenia, aes(x = diagnosis, y = volume, group = pair)) + 
  geom_line()


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(case0202$Unaffected, case0202$Affected, paired = TRUE)


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(case0202$Unaffected - case0202$Affected)


## --------------------------------------------------------------------------------------------------------------------------------------
case0501 %>%
  group_by(Diet) %>%
  summarize(
    n = n(),
    mean = mean(Lifetime),
    sd = sd(Lifetime),
    .groups = "drop"
  )


## --------------------------------------------------------------------------------------------------------------------------------------
ggplot(case0501, aes(x = Diet, y = Lifetime)) +
  geom_jitter(width = 0.1)


## --------------------------------------------------------------------------------------------------------------------------------------
m <- lm(Lifetime ~ Diet, data = case0501)
anova(m)


## --------------------------------------------------------------------------------------------------------------------------------------
m <- lm(Score ~ Treatment, data = case0101)


## --------------------------------------------------------------------------------------------------------------------------------------
summary(m)


## --------------------------------------------------------------------------------------------------------------------------------------
confint(m)


## --------------------------------------------------------------------------------------------------------------------------------------
anova(m)


## --------------------------------------------------------------------------------------------------------------------------------------
m <- lm(Lifetime ~ Diet, data = case0501)
summary(m)


## --------------------------------------------------------------------------------------------------------------------------------------
m <- lm(volume ~ pair + diagnosis, schizophrenia)
summary(m)


## --------------------------------------------------------------------------------------------------------------------------------------
t.test(case0202$Unaffected, case0202$Affected, paired = TRUE)$conf.int
confint(m)[16,]


## --------------------------------------------------------------------------------------------------------------------------------------
case1301 %>% 
  group_by(Block, Treat) %>%
  summarize(
    n = n(),
    mean = mean(Cover),
    sd = sd(Cover),
    .groups = "drop"
  )


## --------------------------------------------------------------------------------------------------------------------------------------
ggplot(case1301, aes(x = Block, y = Cover, shape = Treat, color = Treat)) +
  geom_point()


## --------------------------------------------------------------------------------------------------------------------------------------
ggplot(case1301, aes(x = Treat, y = Cover, shape = Treat, color = Treat)) +
  geom_point() +
  facet_wrap(~Block, ncol = 4)


## --------------------------------------------------------------------------------------------------------------------------------------
m <- lm(Cover ~ Block + Treat, data = case1301)
anova(m) # Two-way ANOVA
summary(m)


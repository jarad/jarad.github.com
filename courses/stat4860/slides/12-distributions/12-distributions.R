## -----------------------------------------------------------------------------------------------------------------------------
library("tidyverse"); theme_set(theme_bw())
library("scales") # for breaks_pretty()


## ---- eval=FALSE--------------------------------------------------------------------------------------------------------------
## ?Distributions


## -----------------------------------------------------------------------------------------------------------------------------
n <- 10
p <- 0.3
d <- data.frame(
  y = 0:n
) %>%
  mutate(pmf = dbinom(y, size = n, prob = p))

ggplot(d, aes(x = y, y = pmf, yend = 0, xend = y)) +
  geom_point() + 
  geom_segment()


## -----------------------------------------------------------------------------------------------------------------------------
d <- d %>%
  mutate(cdf = pbinom(y, size = n, prob = p))

ggplot(d, aes(x = y, y = cdf, yend = 0, xend = y)) +
  geom_step()


## -----------------------------------------------------------------------------------------------------------------------------
n <- 30
p <- 0.4
pbinom(13, size = n, prob = p) - 
  pbinom(1, size = n, prob = p)


## -----------------------------------------------------------------------------------------------------------------------------
draws <- rbinom(1000, size = n, prob = p)

ggplot(mapping = aes(x = draws)) +
  geom_histogram(binwidth = 1)


## -----------------------------------------------------------------------------------------------------------------------------
mean(10 < draws & draws < 14) # vs 
pbinom(13, size = n, prob = p) - 
  pbinom(10, size = n, prob = p)


## -----------------------------------------------------------------------------------------------------------------------------
r <- 3
d <- data.frame(y = 0:(3*r)) %>%
  mutate(pmf = dpois(y, lambda = r),
         cdf = ppois(y, lambda = r))

ggplot(d, aes(x = y, y = pmf, xend = y, yend = 0)) + 
  geom_point() + 
  geom_segment() +
  scale_x_continuous(breaks = breaks_pretty())


## -----------------------------------------------------------------------------------------------------------------------------
ggplot(d, aes(x = y, y = cdf)) + 
  geom_step() +
  scale_x_continuous(breaks = breaks_pretty())


## -----------------------------------------------------------------------------------------------------------------------------
draws <- rpois(1000, lambda = r)

ggplot(mapping = aes(x = draws)) + 
  geom_histogram(binwidth = 1, color = "white") + 
  scale_x_continuous(breaks = breaks_pretty())


## -----------------------------------------------------------------------------------------------------------------------------
m <- 0
s <- 1 # standard deviation

d <- data.frame(x = seq(m - 3*s, m + 3*s, length = 1001)) %>%
  mutate(pdf = dnorm(x, m, s),
         cdf = pnorm(x, m, s))

ggplot(d, aes(x = x, y = pdf)) +
  geom_line()


## -----------------------------------------------------------------------------------------------------------------------------
ggplot(d, aes(x = x, y = cdf)) +
  geom_line()


## -----------------------------------------------------------------------------------------------------------------------------
ggplot(data.frame(p = 0:1)) +
  stat_function(fun = qnorm, n = 1001, args = list(mean = m, sd = s))


## -----------------------------------------------------------------------------------------------------------------------------
qnorm(.975)


## -----------------------------------------------------------------------------------------------------------------------------
draws <- rnorm(20)

ggplot() +
  geom_histogram(mapping = aes(x = draws), bins = 10)


## -----------------------------------------------------------------------------------------------------------------------------
ggplot() +
  geom_histogram(
    mapping = aes(
      x = draws, 
      y = after_stat(density)), 
    bins = 10) +
  stat_function(fun = dnorm, 
                n = 1001, 
                args = list(
                  mean = mean(draws), 
                  sd = sd(draws)),
                color = 'red') +
  xlim(min(draws)-1, max(draws) + 1)


## -----------------------------------------------------------------------------------------------------------------------------
draws <- rnorm(1e4)

ggplot() +
  geom_histogram(
    mapping = aes(
      x = draws, 
      y = after_stat(density)), 
    bins = 30) +
  stat_function(fun = dnorm, 
                n = 1001, 
                args = list(
                  mean = mean(draws), 
                  sd = sd(draws)),
                color = 'red') +
  xlim(min(draws)-1, max(draws) + 1)


## -----------------------------------------------------------------------------------------------------------------------------
df <- 10

d <- data.frame(x = seq(-4, 4, length = 1001)) %>%
  mutate(pdf = dt(x, df = df),
         cdf = pt(x, df = df))

ggplot(d, aes(x = x, y = pdf)) + 
  geom_line() +
  stat_function(fun = dnorm, color = 'red')


## -----------------------------------------------------------------------------------------------------------------------------
y <- round(rnorm(10), 2)
y


## -----------------------------------------------------------------------------------------------------------------------------
n <- length(y); n 
m <- mean(y); m
s <- sd(y); s


## -----------------------------------------------------------------------------------------------------------------------------
t <- (m-1)/(s/sqrt(n)); t


## -----------------------------------------------------------------------------------------------------------------------------
pvalue <- 2*pt(-abs(t), df = n-1); pvalue


## -----------------------------------------------------------------------------------------------------------------------------
t.test(y, mu = 1)$p.value


## -----------------------------------------------------------------------------------------------------------------------------
tcrit <- qt(.95, df = n-1); tcrit


## -----------------------------------------------------------------------------------------------------------------------------
m + c(-1,1)*tcrit*s/sqrt(n)


## -----------------------------------------------------------------------------------------------------------------------------
t.test(y, conf.level = 0.9)$conf.int

